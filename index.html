<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#050505">
    <title>KYNAR UNIVERSE</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    
    <style>
        @font-face { 
            font-family: 'Bantayog'; 
            src: url('https://fonts.cdnfonts.com/s/85631/Bantayog-Regular.woff') format('woff'); 
        }
        body { background-color: #050505; color: #fff; -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body class="overflow-hidden select-none safe-top">

    <div id="boot-loader" class="fixed inset-0 z-[100] bg-black flex items-center justify-center transition-opacity duration-1000">
        <div class="w-12 h-12 border-2 border-white/10 border-t-white rounded-full animate-spin"></div>
    </div>

    <main id="app-scaffold" class="h-screen w-full flex flex-col">
        <section id="main-stage" class="flex-grow overflow-y-auto overflow-x-hidden no-scrollbar">
            <div id="identity-container" class="w-full h-full"></div>
        </section>
    </main>

    <nav class="fixed bottom-0 left-0 w-full h-20 bg-black/80 kynar-glass border-t border-white/5 flex justify-around items-center px-4 pb-safe z-50">
        <button class="nav-icon flex items-center justify-center" onclick="Navigation.teleport('square')" aria-label="Social Square">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
        </button>
        
        <button class="nav-icon flex items-center justify-center" onclick="Navigation.teleport('worlds')" aria-label="Discovery">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2L2 12l10 10 10-10L12 2z"/></svg>
        </button>
        
        <div id="portal-trigger" class="relative -top-5 w-16 h-16 flex items-center justify-center group" onclick="Portal.activate()">
            <div class="absolute inset-0 bg-white/10 blur-2xl rounded-full animate-pulse group-active:scale-150 transition-transform"></div>
            <div id="the-orb" class="w-14 h-14 rounded-full z-10 animate-spin-slow">
                <div class="orb-layer orb-glow"></div>
                <div class="orb-layer orb-glass"></div>
            </div>
        </div>

        <button class="nav-icon flex items-center justify-center" onclick="Navigation.teleport('vault')" aria-label="Vault">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20 12V8H4v4m16 0v8H4v-8m16 0h2M4 12H2M12 4v4m-4 8h8"/></svg>
        </button>
        
        <button class="nav-icon active flex items-center justify-center" onclick="Navigation.teleport('identity')" aria-label="Identity">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="10" r="3"/><path d="M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"/></svg>
        </button>
    </nav>

    <script type="module">
        // Registering SW separately to keep modules clean
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js').catch(err => console.log('Offline Engine Sync Failed', err));
            });
        }
    </script>
    
    <script type="module" src="app.js"></script>

</body>
</html>
