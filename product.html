<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asset Specifications | KYNAR</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1.0.29/bundled/lenis.min.js"></script>
  <script type="module" src="ui-core.js"></script>
</head>
<body>

  <header class="app-header" id="global-header"></header>

  <main class="container" style="padding-top: 140px;">
    
    <div class="flex-between mb-lg reveal-up">
      <a href="shop.html" class="link-arrow">← Return to Archive</a>
      <span class="tag-pill" id="status-pill">System: Ready</span>
    </div>

    <div class="product-spec-grid reveal-up delay-100">
      
      <div class="spec-visual">
        <div class="product-card__image-box" id="product-image-container" style="aspect-ratio: 1/1; background: var(--color-bg-card);">
          </div>
        
        <div class="human-note-card mt-lg">
          <span class="text-xs text-upper text-accent text-bold">Operator Note:</span>
          <p class="text-sm mt-sm italic" id="human-note-text">
            Loading data...
          </p>
        </div>
      </div>

      <div class="spec-data">
        
        <div class="mb-lg">
          <span class="text-xs text-upper text-faded" id="product-id">ID: ---</span>
          <h1 class="heading-lg text-upper mt-xs" id="product-title">Loading Asset...</h1>
          <p class="text-lg text-bold mt-sm" id="product-objective" style="line-height: 1.4;">
            Please select an asset from the Library.
          </p>
        </div>

        <hr style="border: 0; border-top: 1px solid var(--color-border); margin: 30px 0;">

        <div class="specs-matrix mb-lg">
          <div class="spec-item">
            <span class="spec-label">Deploy Time</span>
            <span class="spec-value" id="spec-time">---</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Format</span>
            <span class="spec-value" id="spec-format">---</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Skill Level</span>
            <span class="spec-value" id="spec-skill">---</span>
          </div>
        </div>

        <div class="payload-section mb-xl">
          <span class="text-xs text-upper text-bold mb-sm display-block">Payload Contents:</span>
          <ul class="stack-list" id="payload-list">
            </ul>
        </div>

        <div class="action-bar sticky-bottom">
          <div class="text-xl text-display" id="product-price">£---</div>
          <a href="#" class="btn btn--primary w-full" id="purchase-btn">Secure Asset</a>
        </div>

      </div>

    </div>

  </main>

  <footer id="global-footer"></footer>

  <script type="module">
    import { vault } from './vault.js';

    // 1. Get ID from URL (e.g., product.html?id=sys-001)
    const params = new URLSearchParams(window.location.search);
    const targetId = params.get('id');

    // 2. Find Product
    const product = vault.find(p => p.id === targetId);

    if (product) {
      // INJECT TEXT
      document.title = `${product.title} | Kynar Specs`;
      document.getElementById('product-title').innerText = product.title;
      document.getElementById('product-id').innerText = `ID: ${product.id.toUpperCase()}`;
      document.getElementById('product-objective').innerText = product.objective;
      document.getElementById('human-note-text').innerText = `"${product.human_note}"`;
      document.getElementById('product-price').innerText = product.price;

      // INJECT SPECS
      document.getElementById('spec-time').innerText = product.specs.deploy_time;
      document.getElementById('spec-format').innerText = product.specs.format;
      document.getElementById('spec-skill').innerText = product.specs.skill_level;
      
      // INJECT STATUS PILL
      const statusPill = document.getElementById('status-pill');
      if (product.type === 'system') {
        statusPill.innerText = "System Architecture";
        statusPill.style.background = "var(--color-accent)";
        statusPill.style.color = "var(--color-white)";
      } else {
        statusPill.innerText = "Single Tool";
      }

      // INJECT IMAGE
      const imgContainer = document.getElementById('product-image-container');
      if (product.image) {
        imgContainer.innerHTML = `<img src="${product.image}" alt="${product.title}" style="width:100%; height:100%; object-fit:contain;">`;
      } else {
        imgContainer.innerHTML = `<span class="text-display" style="font-size:6rem; opacity:0.1;">${product.title[0]}</span>`;
      }

      // INJECT PAYLOAD (Loop)
      const list = document.getElementById('payload-list');
      product.payload.forEach(item => {
        const li = document.createElement('li');
        li.innerHTML = `<span class="check">✓</span> ${item}`;
        list.appendChild(li);
      });

      // INJECT LINK
      document.getElementById('purchase-btn').href = product.link;

    } else {
      // 404 State (Product not found)
      document.getElementById('product-title').innerText = "Asset Not Found";
      document.getElementById('product-objective').innerText = "This ID does not exist in the vault.";
      document.getElementById('purchase-btn').style.display = 'none';
    }
  </script>

</body>
</html>
