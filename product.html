<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover" />
  <title>Kynar / Product Detail</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>

  <header class="app-header">
    <div class="header-inner" style="
      width: 100%; max-width: 1200px; margin: 0 auto; 
      display: grid; grid-template-columns: 44px 1fr 44px; align-items: center;
    ">
      <a href="shop.html" class="header-btn">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
      </a>
      <div style="display: flex; justify-content: center;">
         <span style="font-family: var(--font-display); font-weight: 800; letter-spacing: 0.1em; text-transform: uppercase;">Product Detail</span>
      </div>
      <button class="header-btn" id="cart-trigger">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line></svg>
      </button>
    </div>
  </header>

  <main class="product-container">
    
    <div class="product-stage">
       <div class="stage-visual" id="p-bg">
          <div id="p-icon" style="font-size: 5rem; animation: floatIcon 3s ease-in-out infinite;"></div>
       </div>
    </div>

    <div class="product-intel" id="desktop-wrapper">
      
      <div class="intel-header">
        <span class="status-chip" id="p-tag" style="margin-bottom: 0.5rem; display: inline-flex;"></span>
        <h1 class="intel-title" id="p-title">Loading System...</h1>
        <div class="intel-price" id="p-price">--</div>
        <p class="intel-desc" id="p-desc"></p>
      </div>

      <div class="spec-stack">
        <details class="spec-drawer" open>
          <summary class="spec-trigger">
            <span>Core Features</span>
            <svg class="chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
          </summary>
          <div class="spec-content">
            <ul class="feature-list" id="p-features">
              </ul>
          </div>
        </details>

        <details class="spec-drawer">
          <summary class="spec-trigger">
             <span>File Specs</span>
             <svg class="chevron" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
          </summary>
          <div class="spec-content">
             <div class="tech-bit">
                <span class="bit-label">Delivery</span>
                <span class="bit-val">Instant Digital Download</span>
             </div>
          </div>
        </details>
      </div>

    </div>

  </main>

  <div class="sticky-action-bar">
    <div class="action-price">
      <span style="font-size: 0.7rem; color: var(--ink-muted); text-transform: uppercase; font-weight: 700;">Total</span>
      <span style="font-size: 1.1rem; font-weight: 800; color: var(--ink-display);" id="p-price-sticky">--</span>
    </div>
    <button class="action-btn">Add to Cart</button>
  </div>

  <script>
    // 1. THE PRODUCT DATABASE (Add your products here)
    const productDB = {
      'prod_001': {
        title: "Ultimate Notion OS",
        price: "Â£24.00",
        tag: "System Architecture",
        desc: "The definitive workspace for digital creators. Organize projects, manage finances, and track habits in one unified ecosystem.",
        icon: "âš¡",
        bg: "var(--grad-gold)",
        features: ["Project Management Dashboard", "Automated Finance Tracker", "Client CRM Portal", "Mobile-Optimized Layouts"]
      },
      'prod_002': {
        title: "Kids Activity Pack",
        price: "Free",
        tag: "Family Resource",
        desc: "A creative suite of printable assets designed to keep children engaged and learning. Includes coloring, math, and logic puzzles.",
        icon: "ðŸŽ¨",
        bg: "var(--bg-canvas)",
        features: ["50+ Printable Pages", "PDF & PNG Formats", "Age Groups 4-8", "Teacher Approved"]
      },
      'prod_003': {
        title: "Startup Launch Kit",
        price: "Â£15.00",
        tag: "Business Guide",
        desc: "Everything you need to go from zero to launch. Includes pitch decks, financial models, and marketing checklists.",
        icon: "ðŸš€",
        bg: "linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)", // Custom Blue
        features: ["Investor Pitch Deck", "5-Year Financial Model", "Marketing Roadmap", "Legal Checklist"]
      }
    };

        // 2. THE LOGIC
    document.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(window.location.search);
      const id = params.get('id') || 'prod_001'; 
      const data = productDB[id];

      if (data) {
        // Inject Text & Visuals (Existing logic...)
        document.getElementById('p-title').innerText = data.title;
        document.getElementById('p-price').innerText = data.price;
        document.getElementById('p-price-sticky').innerText = data.price;
        document.getElementById('p-desc').innerText = data.desc;
        document.getElementById('p-tag').innerText = data.tag;
        document.getElementById('p-icon').innerText = data.icon;
        document.getElementById('p-bg').style.background = data.bg;
        
        const listContainer = document.getElementById('p-features');
        listContainer.innerHTML = data.features.map(feat => `<li>${feat}</li>`).join('');

        // NEW: ATTACH CART LISTENERS
        // We find both buttons (Sticky Mobile & Desktop)
        const buttons = document.querySelectorAll('.action-btn');
        
        buttons.forEach(btn => {
            btn.onclick = () => {
                // Call the new Cart Engine
                if (window.KynarCart) {
                    window.KynarCart.add({
                        id: id,
                        title: data.title,
                        price: data.price,
                        meta: data.tag,
                        icon: data.icon,
                        bg: data.bg
                    });
                }
            };
        });

        // Desktop Button Injection (CSS Pseudo-element can't click, so we need a real button if we want desktop click)
        // Correction from previous step: CSS ::after cannot be clicked.
        // Let's inject a REAL button for Desktop into the Intel wrapper.
        const desktopBtn = document.createElement('button');
        desktopBtn.className = 'action-btn'; // Reuse class
        desktopBtn.style.marginTop = '2rem';
        desktopBtn.style.width = '100%';
        desktopBtn.innerText = `Add to Cart â€¢ ${data.price}`;
        desktopBtn.onclick = () => {
             if (window.KynarCart) {
                window.KynarCart.add({
                    id: id,
                    title: data.title,
                    price: data.price,
                    meta: data.tag,
                    icon: data.icon,
                    bg: data.bg
                });
            }
        };
        
        // Only append if screen is wide (or just append and let CSS handle display)
        if(window.innerWidth > 800) {
            document.querySelector('.product-intel').appendChild(desktopBtn);
        }
      }
    });

  </script>
  
  <div id="interface-overlay"></div>

<aside id="nav-drawer" class="drawer-panel drawer-left">
    <div class="drawer-header">
        <span class="drawer-title">Menu</span>
        <button class="close-btn" onclick="toggleNav()">âœ•</button>
    </div>
    <nav class="drawer-content">
        <a href="shop.html" class="drawer-link">Marketplace</a>
        <a href="library.html" class="drawer-link">Manuals</a>
        <a href="newsletter.html" class="drawer-link">The Network</a>
        <a href="account.html" class="drawer-link">Member Vault</a>
    </nav>
    <div class="drawer-footer">
        <div class="status-chip">
            <span class="live-beacon"></span> Systems Active
        </div>
    </div>
</aside>

<aside id="cart-drawer" class="drawer-panel drawer-right">
    <div class="drawer-header">
        <span class="drawer-title">Cart (2)</span>
        <button class="close-btn" onclick="toggleCart()">âœ•</button>
    </div>
    
    <div class="drawer-content">
        <div class="cart-item">
            <div class="cart-thumb" style="background: var(--grad-gold);">âš¡</div>
            <div class="cart-details">
                <div class="cart-name">Ultimate Notion OS</div>
                <div class="cart-meta">System Architecture</div>
                <div class="cart-price">Â£24.00</div>
            </div>
            <button class="cart-remove">Ã—</button>
        </div>
        
        <div class="cart-item">
            <div class="cart-thumb" style="background: var(--bg-canvas);">ðŸŽ¨</div>
            <div class="cart-details">
                <div class="cart-name">Kids Activity Pack</div>
                <div class="cart-meta">Digital Asset</div>
                <div class="cart-price">Free</div>
            </div>
            <button class="cart-remove">Ã—</button>
        </div>
    </div>

    <div class="drawer-footer">
        <div class="cart-total-row">
            <span>Subtotal</span>
            <span style="font-weight: 800; color: var(--ink-display);">Â£24.00</span>
        </div>
        <button class="dock-btn" style="width: 100%; justify-content: center; margin-top: 1rem;">
            Secure Checkout
        </button>
    </div>
</aside>


</body>
</html>
