@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --canvas: 40 12% 97%;
    --surface: 210 20% 98%;
    --border: 214 32% 91%;
    --kyn-green: 142 71% 45%;
    --kyn-caramel: 38 48% 39%;
    --kyn-slate: 215 25% 15%;
    --text-primary: 215 25% 7%;
    --text-secondary: 215 16% 47%;
    
    /* Mobile Safe Zones */
    --safe-bottom: env(safe-area-inset-bottom, 1.5rem);
    --safe-top: env(safe-area-inset-top, 0px);
    
    /* Easing Evolved: "The Drift" */
    --ease-kyn-out: cubic-bezier(0.16, 1, 0.3, 1);
  }

  * {
    @apply border-border;
    -webkit-tap-highlight-color: transparent;
  }

  html, body {
    @apply bg-canvas text-text-primary;
    font-feature-settings: "cv02", "cv03", "cv04", "cv11";
    line-height: 1.6;
    overflow-x: hidden;
    width: 100%;
    position: relative;
    min-height: 100svh;
    scroll-behavior: smooth;
  }

  /* Fixed: Selection logic moved out of @apply to pass Turbopack build */
  ::selection {
    background-color: hsl(var(--kyn-green) / 0.15);
    color: inherit;
  }
}

@layer components {
  /* High-end blur for portals */
  .portal-backdrop {
    @apply fixed inset-0 z-[190] bg-kyn-slate-900 backdrop-blur-md;
    background-color: hsl(var(--kyn-slate) / 0.4); /* Manual override for safety */
    transition: backdrop-filter 0.5s var(--ease-kyn-out), background-color 0.5s var(--ease-kyn-out);
  }

  /* Glassmorphism Surface */
  .kynar-glass {
    @apply bg-white/70 backdrop-blur-xl border border-white/20 shadow-kynar-soft;
  }

  .calm-transition {
    transition: all 0.6s var(--ease-kyn-out);
    will-change: transform, opacity, filter;
  }

  .kynar-card {
    @apply calm-transition rounded-kynar-lg border border-border bg-surface hover:shadow-kynar-soft;
  }

  /* Padding for bottom-docked nav */
  .pt-safe-top { 
    padding-top: var(--safe-top); 
  }
  .pb-safe-bottom { 
    padding-bottom: var(--safe-bottom); 
  }
}
